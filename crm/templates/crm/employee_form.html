{% extends 'crm/base.html' %}
{% load i18n %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<div class="container mt-5">
    <h1>{{ title }}</h1>
    
    <form method="post" class="mt-4" style="max-width: 500px;">
        {% csrf_token %}
        
        <div class="mb-3">
            <label for="first_name" class="form-label">{% trans "Имя" %}</label>
            <input type="text" class="form-control" id="first_name" name="first_name" 
                   value="{% if employee %}{{ employee.first_name }}{% endif %}" required>
        </div>

        <div class="mb-3">
            <label for="last_name" class="form-label">{% trans "Фамилия" %}</label>
            <input type="text" class="form-control" id="last_name" name="last_name" 
                   value="{% if employee %}{{ employee.last_name }}{% endif %}" required>
        </div>

        <div class="mb-3">
            <label for="phone" class="form-label">{% trans "Телефон" %}</label>
            <input type="text" class="form-control" id="phone" name="phone" 
                   value="{% if employee %}{{ employee.phone }}{% endif %}">
        </div>

        <div class="mb-3">
            <label for="email" class="form-label">Email</label>
            <input type="email" class="form-control" id="email" name="email" 
                   value="{% if employee %}{{ employee.email }}{% endif %}">
        </div>

        <div class="mb-3">
            <label for="role" class="form-label">{% trans "Должность" %}</label>
            <select class="form-control" id="role" name="role" required>
                {% for value, label in roles %}
                <option value="{{ value }}" {% if employee.role == value %}selected{% endif %}>
                    {{ label }}
                </option>
                {% endfor %}
            </select>
        </div>

        {% if not employee %}
        <div class="mb-3">
            <label class="form-check">
                <input type="checkbox" class="form-check-input" name="link_user">
                <span class="form-check-label">{% trans "Это я (связать с моим аккаунтом)" %}</span>
            </label>
            <small class="form-text text-muted">{% trans "Установите эту галочку, если вы сами являетесь сотрудником" %}</small>
        </div>
        {% endif %}

        {% if employee %}
        <div class="mb-3">
            <label class="form-check">
                <input type="checkbox" class="form-check-input" name="is_active" 
                       {% if employee.is_active %}checked{% endif %}>
                <span class="form-check-label">{% trans "Активен" %}</span>
            </label>
        </div>
        {% endif %}

        <button type="submit" class="btn btn-primary">{% trans "Сохранить" %}</button>
        <a href="{% url 'employee_list' %}" class="btn btn-secondary">{% trans "Отмена" %}</a>
    </form>
</div>
{% endblock %}
